## VISUALISATIONS ##

#The colour spectrum below is used to show rarity from 1-12%, going from red to blue:
 spectrum b, red_magenta_purple_orange_brightorange_yellow_limon_green_cyan_teal_blue_white, minimum=0.01, maximum=0.12,

## PROJECT DIRECTION ##

 Want to find some E. Coli proteins that has:
1. A full nucleotide available (easier b.c. no splicing)
2. A solved structure pdb file (no garuantee that the nucleotide seq is an exact link, if E coli should be close)
3. Interesting structural features that could be implicated in a translational speed bottleneck, potentially due to rare codons


The RefSeq data and PDB AA sequences will have objects not in the other (e.g. poly-A in the former, ligands HOH in the latter). So manually AA alignment for now, think about robust error handling in databases only if/when this project has wings.

Candidates: 
    - ROP/ROM protein: simple, many variants (inc. res. deletion), are there rare codons? 
    - MerB alykl mercury lyase:  interesting motifs looping between alpha-helices, diverse AA usage 
    - Apo-NikR, Ni responsive Trans.Fact.: cons tetramer, pros interesting structure
    - Succinate (e.g. 1NEK): 4 subunits joined to still keep an extended set of a-helices. Maybe too complex, but check at those hairpin turns


Immediate improvement:
  - Each program generates a .log file from the name specified by -o by the user. This prints all the info (codon tables, rarity and codon sequence at each amino acid index, mean scores)  

Long-term improvement:
  - Use the codon table of the organism, do seq codon search for <5% & <10%. They are probably there for a reason in the folding. Can plot white background with red higlights for <5% codons, and white with orange index highlights for <10%. Keep this consistent colour scheme. 
    - Try this with the unable to express protein that is the heart of the HepB, that you could do with assays     
  - Could turn the rarity at each position into an array -> 2D 'stripe' of colours of those values.
  - You could then line up these 'stripes' of pixels vertically between different expressions of the same protein, and see where is more blue, where more red, without complication of 3D structure. Easier and more informative than 'mean' diff value. 
    - Use seismic matplotlib colorscheme: plot_color_gradients('Diverging', 'seismic') 
  - compare automatic lik4like with Steph's manual ones for Nelly archeon 
  - Explore what a sensible rarity value cut-off is for model organisms, have option to only report rare codons
  - Link to Ramachandran of amino acids at structurally crucial positions
    - There's a python package for Ramachandran plots generation called COOT. Input is a pdb file.     (sort out what pdb data we actually want, and how to link with nucleic acid seqs downloading them automatically is easy) 
    - N.B. AlphaFold has shortcomings with predicting Ramachadran plots, but experimentally solved structures are more sensible for Ramachandran params 
  - *really* important candidate codons are *both* for amino acids that are at important positions *and* rare for that organism
  - Report these really important candidate codons in the python scripts so the user can inspect
  - Chances are any single numerical value won't work: want mean, median, std dev, and visual info...
